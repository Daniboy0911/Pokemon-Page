<!DOCTYPE html>
<html>

<head>
    <title>TCGdex API Comprehensive Test</title>
    <style>
        .test-section {
            margin: 20px;
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        .success {
            color: green;
        }

        .error {
            color: red;
        }

        img {
            max-width: 200px;
        }
    </style>
</head>

<body>
    <h1>TCGdex API Comprehensive Test</h1>

    <div class="test-section">
        <h2>1. Basic SDK Test</h2>
        <div id="basic-test"></div>
    </div>

    <div class="test-section">
        <h2>2. Random Data Test</h2>
        <div id="random-test"></div>
    </div>

    <div class="test-section">
        <h2>3. Query Test</h2>
        <div id="query-test"></div>
    </div>

    <div class="test-section">
        <h2>4. Relations Test</h2>
        <div id="relations-test"></div>
    </div>

    <div class="test-section">
        <h2>5. Attribute Filter Test</h2>
        <div id="filter-test"></div>
    </div>

    <div class="test-section">
        <h2>6. Image Test</h2>
        <div id="image-test"></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@tcgdex/sdk@2/dist/tcgdex.browser.js"></script>
    <script>
        // Helper function to log results
        function logResult(elementId, message, isError = false) {
            const div = document.getElementById(elementId);
            const p = document.createElement('p');
            p.className = isError ? 'error' : 'success';
            p.textContent = message;
            div.appendChild(p);
        }

        // Helper function to display card image
        function displayImage(elementId, url, alt) {
            const div = document.getElementById(elementId);
            const img = document.createElement('img');
            img.src = url;
            img.alt = alt;
            div.appendChild(img);
        }

        document.addEventListener('DOMContentLoaded', async () => {
            try {
                // Initialize SDK
                const tcgdex = new TCGdex('es');
                logResult('basic-test', '✅ SDK initialized successfully');

                // Test 1: Basic Operations
                try {
                    // Get specific card
                    const card = await tcgdex.card.get('swsh3-136');
                    logResult('basic-test', `✅ Got specific card: ${card.name}`);

                    // Get specific set
                    const set = await tcgdex.set.get('swsh3');
                    logResult('basic-test', `✅ Got specific set: ${set.name}`);

                    // Get specific series
                    const serie = await tcgdex.serie.get('swsh');
                    logResult('basic-test', `✅ Got specific series: ${serie.name}`);

                    // Get all cards
                    const allCards = await tcgdex.card.list();
                    logResult('basic-test', `✅ Got all cards: ${allCards.length} cards found`);
                } catch (error) {
                    logResult('basic-test', `❌ Basic operations error: ${error.message}`, true);
                }

                // Test 2: Random Data
                try {
                    // Get random card
                    const randomCard = await tcgdex.random.card();
                    logResult('random-test', `✅ Got random card: ${randomCard.name}`);

                    // Get random set
                    const randomSet = await tcgdex.random.set();
                    logResult('random-test', `✅ Got random set: ${randomSet.name}`);

                    // Get random series
                    const randomSerie = await tcgdex.random.serie();
                    logResult('random-test', `✅ Got random series: ${randomSerie.name}`);
                } catch (error) {
                    logResult('random-test', `❌ Random data error: ${error.message}`, true);
                }

                // Test 3: Advanced Queries
                try {
                    // Query for Pikachu cards
                    const pikachuCards = await tcgdex.card.list(
                        Query.create()
                            .equal('name', 'Pikachu')
                            .greaterOrEqualThan('hp', 60)
                            .lesserThan('hp', 70)
                    );
                    logResult('query-test', `✅ Found ${pikachuCards.length} Pikachu cards`);

                    // Paginated query
                    const paginatedCards = await tcgdex.card.list(
                        Query.create().paginate(1, 5)
                    );
                    logResult('query-test', `✅ Got paginated cards: ${paginatedCards.length} cards`);
                } catch (error) {
                    logResult('query-test', `❌ Query error: ${error.message}`, true);
                }

                // Test 4: Object Relations
                try {
                    const card = await tcgdex.card.get('swsh3-136');
                    const set = await card.getSet();
                    logResult('relations-test', `✅ Card belongs to set: ${set.name}`);

                    const serie = await set.getSerie();
                    logResult('relations-test', `✅ Set belongs to series: ${serie.name}`);
                } catch (error) {
                    logResult('relations-test', `❌ Relations error: ${error.message}`, true);
                }

                // Test 5: Attribute Filters
                try {
                    const fireType = await tcgdex.type.get('fire');
                    logResult('filter-test', `✅ Found ${fireType.length} fire type cards`);

                    const hp90Cards = await tcgdex.hp.get('90');
                    logResult('filter-test', `✅ Found ${hp90Cards.length} cards with 90 HP`);

                    const rareCards = await tcgdex.rarity.get('rare');
                    logResult('filter-test', `✅ Found ${rareCards.length} rare cards`);
                } catch (error) {
                    logResult('filter-test', `❌ Filter error: ${error.message}`, true);
                }

                // Test 6: Card Images
                try {
                    const card = await tcgdex.card.get('swsh3-136');
                    const highQualityPng = card.getImageURL('high', 'png');
                    const lowQualityWebp = card.getImageURL('low', 'webp');

                    logResult('image-test', '✅ High quality PNG URL: ' + highQualityPng);
                    logResult('image-test', '✅ Low quality WebP URL: ' + lowQualityWebp);

                    // Display images
                    displayImage('image-test', highQualityPng, 'High quality card');
                    displayImage('image-test', lowQualityWebp, 'Low quality card');
                } catch (error) {
                    logResult('image-test', `❌ Image error: ${error.message}`, true);
                }

            } catch (error) {
                logResult('basic-test', `❌ Global error: ${error.message}`, true);
            }
        });
    </script>
</body>

</html>